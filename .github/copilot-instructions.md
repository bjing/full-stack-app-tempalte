**Purpose**
- **Goal:** Help AI coding agents become productive quickly in this repository.

**Big Picture**
- **Architecture:** Monorepo with two main apps: a Haskell backend (`/backend`) providing a small Servant API, and a Next.js frontend (`/frontend`) serving the UI.
- **Backend entry:** `backend/app/Main.hs` calls `Lib.startApp` in `backend/src/Lib.hs` which runs a Warp server on port `8080`.
- **Frontend entry:** `frontend/app/page.tsx` is the default Next.js App Router page; dev server runs on `3000`.

**Build & Dev Commands**
  - `cd backend && stack build`
  - `cd backend && stack test`
  Run server locally with the executable produced by Stack (or after `stack build`).
 **Note:** Configuration comes from `backend/stack.yaml` and `backend/package.yaml` (hpack). Do NOT edit the generated `.cabal` file directly.
- **Frontend (Next.js):**
  - Start dev server: `cd frontend && npm run dev`
  - Build: `cd frontend && npm run build`
  - Start production server: `cd frontend && npm run start`

**Testing & Formatting**
- **Backend tests:** use `stack test` (tests use `hspec`, `hspec-wai`, `hspec-wai-json`). Tests are declared in `package.yaml` under `tests` and expect `test/` sources.
- **Formatter:** backend recommends `stylish-haskell` (install via `stack install stylish-haskell`).
- **Frontend linting:** `cd frontend && npm run lint` uses project `eslint` config (`eslint.config.mjs`). There are no frontend tests present by default.

**Project-specific Patterns & Conventions**
- **Hpack-first Haskell:** `backend/package.yaml` is the source of truth; `myserver.cabal` is generated by `hpack`. Update `package.yaml` and `stack.yaml` instead of editing the `.cabal` file.
- **Servant API surface:** API types are defined in `backend/src/Lib.hs` (example: `type API = "users" :> Get ...`). Server handlers live alongside the API definition in `Lib.hs` for this template.
- **JSON derivation:** Uses `aeson` + `Data.Aeson.TH` and `$(deriveJSON ...)` in `backend/src/Lib.hs` — follow that pattern for simple DTOs.
- **Ports & integration:** Backend listens on port `8080`; frontend dev server is `3000`. There's no built-in proxy configured — if you add API calls from the frontend, either set up a proxy or call `http://localhost:8080` directly during development.

**Where to Change Behavior**
- To change the HTTP port or server behavior, edit `backend/src/Lib.hs` (the `startApp` and `run` call). For larger changes, add new modules under `backend/src` and export them in `package.yaml` as needed.
- To add frontend routes or pages, modify files under `frontend/app/` (App Router). Static assets live under `frontend/public/`.

**Dependencies & Integration Points**
- Haskell deps: listed in `backend/package.yaml` (e.g., `servant-server`, `warp`, `aeson`). Use `stack`/`stack.yaml` to pin resolver.
- Node deps: `frontend/package.json` (Next 16 + React 19). Use the package manager installed locally (npm/pnpm/yarn) to run scripts.

**Quick Examples**
- Add a new API route: create a new type in `backend/src/Lib.hs` (or a new module), add handler to `server` and expose via `API` type and `api` Proxy.
- JSON DTOs: follow `User` in `backend/src/Lib.hs` and use `$(deriveJSON defaultOptions ''MyType)`.

**Notes & Caveats**
- Top-level `README.md` is empty — primary documentation is split into `/backend/README.md` and `/frontend/README.md`.
- There are no CI or GitHub Actions present (no `.github/workflows`); if adding CI, ensure Haskell `stack` builds and Next build/lint steps are covered.
- If you change Haskell dependencies or GHC resolver, update `backend/stack.yaml` and run `stack build` locally to verify.

**If you are not sure**
- Prefer reading `backend/package.yaml`, `backend/stack.yaml`, `backend/src/Lib.hs` and `frontend/package.json`, `frontend/app/page.tsx` for concrete examples.
- Ask the maintainer which port-forwarding or proxy conventions they want for local integration (frontend↔backend).

---
Please review this draft — tell me if you want more details (CORS rules, CI steps, or examples of adding an API route).

**CI**
- **Workflow file:** `.github/workflows/ci.yml` — runs on `push` and `pull_request` for `main` and `setup` branches.
- **Jobs:**
  - `backend`: runs on `ubuntu-latest`, installs `stack`, runs `stack setup`, `stack build` and `stack test` in the `backend` directory.
  - `frontend`: runs on `ubuntu-latest` with Node 20, runs `npm ci`, `npm run build`, and `npm run lint` in the `frontend` directory.
- **Caching:**
  - Backend cache saves `~/.stack` keyed by `backend/stack.yaml` and `backend/package.yaml` fingerprints.
  - Frontend cache saves `~/.npm` and `frontend/node_modules` keyed by `frontend/package.json`/`package-lock.json`.
- **Badge:** A workflow badge has been added to the top-level `README.md` and points to the `ci.yml` workflow.
- **Local verification:** To reproduce CI steps locally run:

  - Backend:

    ```bash
    cd backend
    stack setup
    stack build
    stack test
    ```

  - Frontend:

    ```bash
    cd frontend
    npm ci
    npm run build
    npm run lint
    ```

- **If you change the workflow:** update `.github/workflows/ci.yml` and adjust the badge URL in `README.md` if the workflow filename changes.
